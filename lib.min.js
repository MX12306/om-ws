!function(){"use strict";function a(a,b){i=i||{},i[a]=i[a]||[],i[a].push(b)}function b(a,b){i=i||{},a in i!=!1&&i[a].splice(i[a].indexOf(b),1)}function c(a){if(i=i||{},a in i!=!1)for(var b=0;b<i[a].length;b++)i[a][b].apply(this,Array.prototype.slice.call(arguments,1))}function d(a){var b=function(a,b,c){for(var d=new ArrayBuffer(2*c),e=new Uint16Array(d),f=0;c>f;++f)e[f]=a.getUint8(b+f);return String.fromCharCode.apply(null,e)},c=new DataView(a),d=b(c,0,2);if("om"!==d)throw new Error("Invalid packet type");var e={};if(e.version=c.getUint8(2),e.version!==g)throw new Error("Invalid version "+e.version+" in received packet");e.action=c.getUint8(3),e.size=c.getUint32(4),e.data={};for(var f=new Uint8Array(a.slice(8,a.byteLength)),h=function(a,b){if(-1===a.indexOf("."))return void(e.data[a]=b);for(var c=a.split("."),d=e.data,f=0;f<c.length;f++){if("undefined"!=typeof d[c[f]]&&"object"!=typeof d[c[f]])throw new Error("Fail to set "+a+" key. Key "+c[f]+" already present as non object");"undefined"==typeof d[c[f]]&&(d[c[f]]={}),f<c.length-1?"object"==typeof d[c[f]]&&(d=d[c[f]]):d[c[f]]=b}},i="",j=[],k=!0,l=[192,128],m=0;m<f.byteLength-1;m++)f[m]===l[0]&&f[m+1]===l[1]?(j=String.fromCharCode.apply(null,j),k?i=j:h(i,j),j=[],k=!k):f[m]!==l[1]&&j.push(f[m]);return e}function e(a,b){var c=new ArrayBuffer(512),d=new DataView(c);d.setUint8(0,111),d.setUint8(1,109),d.setUint8(2,g),d.setUint8(3,a),d.setUint32(4,123);var e=8,f=function(a){for(var b=0;b<a.length;b++)d.setUint8(e,a[b].charCodeAt(0)),e++},h=function(){d.setUint8(e,192),e++,d.setUint8(e,128),e++};for(var i in b)f(i),h(),f(b[i]+""),h();return d.buffer}function f(a,b){j.send(e(a,b))}var g="{{.version}}",h="ws://{{.endpoint}}/",i={},j=new WebSocket(h);j.binaryType="arraybuffer",j.onopen=function(){c("open")},j.onclose=function(){c("close")},j.onmessage=function(){if(""!==event.data)try{c("data",d(event.data))}catch(a){c("error","Fail to decode packet")}};var k={on:a,off:b,send:f};Object.defineProperty(k,"connected",{get:function(){return 1===j.readyState}}),window.omsocket=k,"function"==typeof window.omSocketReady&&omSocketReady(window.omsocket)}();